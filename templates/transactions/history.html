{% extends 'base.html' %}
{% load crispy_forms_tags %}
{% block content %}
<h3>Transaction History</h3>

<div class="card mb-3">
  <div class="card-body">
    <form method="get" class="row g-2 align-items-end">
      <div class="col-md-2">{{ form.transaction_type|as_crispy_field }}</div>
      <div class="col-md-2">{{ form.category|as_crispy_field }}</div>
      <div class="col-md-2">{{ form.account|as_crispy_field }}</div>
      <div class="col-md-2">{{ form.start_date|as_crispy_field }}</div>
      <div class="col-md-2">{{ form.end_date|as_crispy_field }}</div>
      <div class="col-md-2"><button class="btn btn-primary w-100">Filter</button></div>
    </form>
  </div>
</div>

<div class="table-responsive">
  <table class="table table-striped align-middle">
    <thead>
      <tr>
        <th>Date</th>
        <th>Type</th>
        <th>Category</th>
        <th>Account</th>
        <th>Related</th>
        <th class="text-end">Amount</th>
      </tr>
    </thead>
    <tbody>
      {% for t in transactions %}
        <tr>
          <td>{{ t.created_at|date:'Y-m-d H:i' }}</td>
          <td>{{ t.get_transaction_type_display }}</td>
          <td>{{ t.get_category_display }}</td>
          <td>{{ t.account.account_number }}</td>
          <td>{% if t.related_account %}{{ t.related_account.account_number }}{% endif %}</td>
          <td class="text-end">${{ t.amount }}</td>
        </tr>
      {% empty %}
        <tr><td colspan="6">No transactions</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}

